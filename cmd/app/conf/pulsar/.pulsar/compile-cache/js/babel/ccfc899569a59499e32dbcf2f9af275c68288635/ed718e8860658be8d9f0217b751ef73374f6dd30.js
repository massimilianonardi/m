"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;
var _atomSelectList = _interopRequireDefault(require("atom-select-list"));
var _underscorePlus = require("underscore-plus");
function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }
/** @babel */

class CommandPaletteView {
  constructor(initiallyVisibleItemCount = 10) {
    this.filter = (items, query) => {
      if (query.length === 0) {
        return items;
      }
      const scoredItems = [];
      for (const item of items) {
        let score = atom.ui.fuzzyMatcher.score(item.displayName, query);
        if (item.tags) {
          score += item.tags.reduce((currentScore, tag) => currentScore + atom.ui.fuzzyMatcher.score(tag, query), 0);
        }
        if (item.description) {
          score += atom.ui.fuzzyMatcher.score(item.description, query);
        }
        if (score > 0) {
          scoredItems.push({
            item,
            score
          });
        }
      }
      scoredItems.sort((a, b) => b.score - a.score);
      return scoredItems.map(i => i.item);
    };
    this.keyBindingsForActiveElement = [];
    this.selectListView = new _atomSelectList.default({
      initiallyVisibleItemCount: initiallyVisibleItemCount,
      // just for being able to disable visible-on-render in spec
      items: [],
      filter: this.filter,
      emptyMessage: 'No matches found',
      elementForItem: (item, {
        index,
        selected,
        visible
      }) => {
        if (!visible) {
          return document.createElement("li");
        }
        const li = document.createElement('li');
        li.classList.add('event', 'two-lines');
        li.dataset.eventName = item.name;
        const rightBlock = document.createElement('div');
        rightBlock.classList.add('pull-right');
        this.keyBindingsForActiveElement.filter(({
          command
        }) => command === item.name).forEach(keyBinding => {
          const kbd = document.createElement('kbd');
          kbd.classList.add('key-binding');
          kbd.textContent = (0, _underscorePlus.humanizeKeystroke)(keyBinding.keystrokes);
          rightBlock.appendChild(kbd);
        });
        li.appendChild(rightBlock);
        const leftBlock = document.createElement('div');
        const titleEl = document.createElement('div');
        titleEl.classList.add('primary-line');
        titleEl.title = item.name;
        leftBlock.appendChild(titleEl);
        const query = this.selectListView.getQuery();
        this.highlightMatchesInElement(item.displayName, query, titleEl);
        if (selected) {
          let secondaryEl = document.createElement('div');
          secondaryEl.classList.add('secondary-line');
          secondaryEl.style.display = 'flex';
          if (typeof item.description === 'string') {
            secondaryEl.appendChild(this.createDescription(item.description, query));
          }
          if (Array.isArray(item.tags)) {
            const matchingTags = item.tags.map(t => [t, atom.ui.fuzzyMatcher.score(t, query)]).filter(([t, s]) => s > 0).sort((a, b) => a.s - b.s).map(([t, s]) => t);
            if (matchingTags.length > 0) {
              secondaryEl.appendChild(this.createTags(matchingTags, query));
            }
          }
          leftBlock.appendChild(secondaryEl);
        }
        li.appendChild(leftBlock);
        return li;
      },
      didConfirmSelection: keyBinding => {
        this.hide();
        const event = new CustomEvent(keyBinding.name, {
          bubbles: true,
          cancelable: true
        });
        this.activeElement.dispatchEvent(event);
      },
      didCancelSelection: () => {
        this.hide();
      }
    });
    this.selectListView.element.classList.add('command-palette');
  }
  async destroy() {
    await this.selectListView.destroy();
  }
  toggle() {
    if (this.panel && this.panel.isVisible()) {
      this.hide();
      return Promise.resolve();
    } else {
      return this.show();
    }
  }
  async show(showHiddenCommands = false) {
    if (!this.panel) {
      this.panel = atom.workspace.addModalPanel({
        item: this.selectListView
      });
    }
    if (!this.preserveLastSearch) {
      this.selectListView.reset();
    } else {
      this.selectListView.refs.queryEditor.selectAll();
    }
    this.activeElement = document.activeElement === document.body ? atom.views.getView(atom.workspace) : document.activeElement;
    this.keyBindingsForActiveElement = atom.keymaps.findKeyBindings({
      target: this.activeElement
    });
    const commandsForActiveElement = atom.commands.findCommands({
      target: this.activeElement
    }).filter(command => showHiddenCommands === !!command.hiddenInCommandPalette);
    commandsForActiveElement.sort((a, b) => a.displayName.localeCompare(b.displayName));
    await this.selectListView.update({
      items: commandsForActiveElement
    });
    this.previouslyFocusedElement = document.activeElement;
    this.panel.show();
    this.selectListView.focus();
  }
  hide() {
    this.panel.hide();
    if (this.previouslyFocusedElement) {
      this.previouslyFocusedElement.focus();
      this.previouslyFocusedElement = null;
    }
  }
  async update(props) {
    if (props.hasOwnProperty('preserveLastSearch')) {
      this.preserveLastSearch = props.preserveLastSearch;
    }
  }
  highlightMatchesInElement(text, query, el) {
    var _matches$matchIndexes;
    const matches = atom.ui.fuzzyMatcher.match(text, query, {
      recordMatchIndexes: true
    });
    let matchedChars = [];
    let lastIndex = 0;
    const matchIndexes = matches ? (_matches$matchIndexes = matches.matchIndexes) !== null && _matches$matchIndexes !== void 0 ? _matches$matchIndexes : [] : [];
    matchIndexes.forEach(matchIndex => {
      const unmatched = text.substring(lastIndex, matchIndex);
      if (unmatched) {
        if (matchedChars.length > 0) {
          const matchSpan = document.createElement('span');
          matchSpan.classList.add('character-match');
          matchSpan.textContent = matchedChars.join('');
          el.appendChild(matchSpan);
          matchedChars = [];
        }
        el.appendChild(document.createTextNode(unmatched));
      }
      matchedChars.push(text[matchIndex]);
      lastIndex = matchIndex + 1;
    });
    if (matchedChars.length > 0) {
      const matchSpan = document.createElement('span');
      matchSpan.classList.add('character-match');
      matchSpan.textContent = matchedChars.join('');
      el.appendChild(matchSpan);
    }
    const unmatched = text.substring(lastIndex);
    if (unmatched) {
      el.appendChild(document.createTextNode(unmatched));
    }
  }
  createDescription(description, query) {
    const descriptionEl = document.createElement('div');

    // in case of overflow, give full contents on long hover
    descriptionEl.title = description;
    Object.assign(descriptionEl.style, {
      flexGrow: 1,
      flexShrink: 1,
      textOverflow: 'ellipsis',
      whiteSpace: 'nowrap',
      overflow: 'hidden'
    });
    this.highlightMatchesInElement(description, query, descriptionEl);
    return descriptionEl;
  }
  createTag(tagText, query) {
    const tagEl = document.createElement('li');
    Object.assign(tagEl.style, {
      borderBottom: 0,
      display: 'inline',
      padding: 0
    });
    this.highlightMatchesInElement(tagText, query, tagEl);
    return tagEl;
  }
  createTags(matchingTags, query) {
    const tagsEl = document.createElement('ol');
    Object.assign(tagsEl.style, {
      display: 'inline',
      marginLeft: '4px',
      flexShrink: 0,
      padding: 0
    });
    const introEl = document.createElement('strong');
    introEl.textContent = 'matching tags: ';
    tagsEl.appendChild(introEl);
    matchingTags.map(t => this.createTag(t, query)).forEach((tagEl, i) => {
      tagsEl.appendChild(tagEl);
      if (i < matchingTags.length - 1) {
        const commaSpace = document.createElement('span');
        commaSpace.textContent = ', ';
        tagsEl.appendChild(commaSpace);
      }
    });
    return tagsEl;
  }
}
exports.default = CommandPaletteView;
module.exports = exports.default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJDb21tYW5kUGFsZXR0ZVZpZXciLCJjb25zdHJ1Y3RvciIsImluaXRpYWxseVZpc2libGVJdGVtQ291bnQiLCJmaWx0ZXIiLCJpdGVtcyIsInF1ZXJ5IiwibGVuZ3RoIiwic2NvcmVkSXRlbXMiLCJpdGVtIiwic2NvcmUiLCJhdG9tIiwidWkiLCJmdXp6eU1hdGNoZXIiLCJkaXNwbGF5TmFtZSIsInRhZ3MiLCJyZWR1Y2UiLCJjdXJyZW50U2NvcmUiLCJ0YWciLCJkZXNjcmlwdGlvbiIsInB1c2giLCJzb3J0IiwiYSIsImIiLCJtYXAiLCJpIiwia2V5QmluZGluZ3NGb3JBY3RpdmVFbGVtZW50Iiwic2VsZWN0TGlzdFZpZXciLCJTZWxlY3RMaXN0VmlldyIsImVtcHR5TWVzc2FnZSIsImVsZW1lbnRGb3JJdGVtIiwiaW5kZXgiLCJzZWxlY3RlZCIsInZpc2libGUiLCJkb2N1bWVudCIsImNyZWF0ZUVsZW1lbnQiLCJsaSIsImNsYXNzTGlzdCIsImFkZCIsImRhdGFzZXQiLCJldmVudE5hbWUiLCJuYW1lIiwicmlnaHRCbG9jayIsImNvbW1hbmQiLCJmb3JFYWNoIiwia2V5QmluZGluZyIsImtiZCIsInRleHRDb250ZW50IiwiaHVtYW5pemVLZXlzdHJva2UiLCJrZXlzdHJva2VzIiwiYXBwZW5kQ2hpbGQiLCJsZWZ0QmxvY2siLCJ0aXRsZUVsIiwidGl0bGUiLCJnZXRRdWVyeSIsImhpZ2hsaWdodE1hdGNoZXNJbkVsZW1lbnQiLCJzZWNvbmRhcnlFbCIsInN0eWxlIiwiZGlzcGxheSIsImNyZWF0ZURlc2NyaXB0aW9uIiwiQXJyYXkiLCJpc0FycmF5IiwibWF0Y2hpbmdUYWdzIiwidCIsInMiLCJjcmVhdGVUYWdzIiwiZGlkQ29uZmlybVNlbGVjdGlvbiIsImhpZGUiLCJldmVudCIsIkN1c3RvbUV2ZW50IiwiYnViYmxlcyIsImNhbmNlbGFibGUiLCJhY3RpdmVFbGVtZW50IiwiZGlzcGF0Y2hFdmVudCIsImRpZENhbmNlbFNlbGVjdGlvbiIsImVsZW1lbnQiLCJkZXN0cm95IiwidG9nZ2xlIiwicGFuZWwiLCJpc1Zpc2libGUiLCJQcm9taXNlIiwicmVzb2x2ZSIsInNob3ciLCJzaG93SGlkZGVuQ29tbWFuZHMiLCJ3b3Jrc3BhY2UiLCJhZGRNb2RhbFBhbmVsIiwicHJlc2VydmVMYXN0U2VhcmNoIiwicmVzZXQiLCJyZWZzIiwicXVlcnlFZGl0b3IiLCJzZWxlY3RBbGwiLCJib2R5Iiwidmlld3MiLCJnZXRWaWV3Iiwia2V5bWFwcyIsImZpbmRLZXlCaW5kaW5ncyIsInRhcmdldCIsImNvbW1hbmRzRm9yQWN0aXZlRWxlbWVudCIsImNvbW1hbmRzIiwiZmluZENvbW1hbmRzIiwiaGlkZGVuSW5Db21tYW5kUGFsZXR0ZSIsImxvY2FsZUNvbXBhcmUiLCJ1cGRhdGUiLCJwcmV2aW91c2x5Rm9jdXNlZEVsZW1lbnQiLCJmb2N1cyIsInByb3BzIiwiaGFzT3duUHJvcGVydHkiLCJ0ZXh0IiwiZWwiLCJtYXRjaGVzIiwibWF0Y2giLCJyZWNvcmRNYXRjaEluZGV4ZXMiLCJtYXRjaGVkQ2hhcnMiLCJsYXN0SW5kZXgiLCJtYXRjaEluZGV4ZXMiLCJtYXRjaEluZGV4IiwidW5tYXRjaGVkIiwic3Vic3RyaW5nIiwibWF0Y2hTcGFuIiwiam9pbiIsImNyZWF0ZVRleHROb2RlIiwiZGVzY3JpcHRpb25FbCIsIk9iamVjdCIsImFzc2lnbiIsImZsZXhHcm93IiwiZmxleFNocmluayIsInRleHRPdmVyZmxvdyIsIndoaXRlU3BhY2UiLCJvdmVyZmxvdyIsImNyZWF0ZVRhZyIsInRhZ1RleHQiLCJ0YWdFbCIsImJvcmRlckJvdHRvbSIsInBhZGRpbmciLCJ0YWdzRWwiLCJtYXJnaW5MZWZ0IiwiaW50cm9FbCIsImNvbW1hU3BhY2UiXSwic291cmNlcyI6WyJjb21tYW5kLXBhbGV0dGUtdmlldy5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKiogQGJhYmVsICovXG5cbmltcG9ydCBTZWxlY3RMaXN0VmlldyBmcm9tICdhdG9tLXNlbGVjdC1saXN0J1xuaW1wb3J0IHtodW1hbml6ZUtleXN0cm9rZX0gZnJvbSAndW5kZXJzY29yZS1wbHVzJ1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBDb21tYW5kUGFsZXR0ZVZpZXcge1xuICBjb25zdHJ1Y3RvciAoaW5pdGlhbGx5VmlzaWJsZUl0ZW1Db3VudCA9IDEwKSB7XG4gICAgdGhpcy5rZXlCaW5kaW5nc0ZvckFjdGl2ZUVsZW1lbnQgPSBbXVxuICAgIHRoaXMuc2VsZWN0TGlzdFZpZXcgPSBuZXcgU2VsZWN0TGlzdFZpZXcoe1xuICAgICAgaW5pdGlhbGx5VmlzaWJsZUl0ZW1Db3VudDogaW5pdGlhbGx5VmlzaWJsZUl0ZW1Db3VudCwgLy8ganVzdCBmb3IgYmVpbmcgYWJsZSB0byBkaXNhYmxlIHZpc2libGUtb24tcmVuZGVyIGluIHNwZWNcbiAgICAgIGl0ZW1zOiBbXSxcbiAgICAgIGZpbHRlcjogdGhpcy5maWx0ZXIsXG4gICAgICBlbXB0eU1lc3NhZ2U6ICdObyBtYXRjaGVzIGZvdW5kJyxcbiAgICAgIGVsZW1lbnRGb3JJdGVtOiAoaXRlbSwge2luZGV4LCBzZWxlY3RlZCwgdmlzaWJsZX0pID0+IHtcbiAgICAgICAgaWYgKCF2aXNpYmxlKSB7XG4gICAgICAgICAgcmV0dXJuIGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJsaVwiKVxuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgbGkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdsaScpXG4gICAgICAgIGxpLmNsYXNzTGlzdC5hZGQoJ2V2ZW50JywgJ3R3by1saW5lcycpXG4gICAgICAgIGxpLmRhdGFzZXQuZXZlbnROYW1lID0gaXRlbS5uYW1lXG5cbiAgICAgICAgY29uc3QgcmlnaHRCbG9jayA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpXG4gICAgICAgIHJpZ2h0QmxvY2suY2xhc3NMaXN0LmFkZCgncHVsbC1yaWdodCcpXG5cbiAgICAgICAgdGhpcy5rZXlCaW5kaW5nc0ZvckFjdGl2ZUVsZW1lbnRcbiAgICAgICAgLmZpbHRlcigoe2NvbW1hbmR9KSA9PiBjb21tYW5kID09PSBpdGVtLm5hbWUpXG4gICAgICAgIC5mb3JFYWNoKGtleUJpbmRpbmcgPT4ge1xuICAgICAgICAgIGNvbnN0IGtiZCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2tiZCcpXG4gICAgICAgICAga2JkLmNsYXNzTGlzdC5hZGQoJ2tleS1iaW5kaW5nJylcbiAgICAgICAgICBrYmQudGV4dENvbnRlbnQgPSBodW1hbml6ZUtleXN0cm9rZShrZXlCaW5kaW5nLmtleXN0cm9rZXMpXG4gICAgICAgICAgcmlnaHRCbG9jay5hcHBlbmRDaGlsZChrYmQpXG4gICAgICAgIH0pXG4gICAgICAgIGxpLmFwcGVuZENoaWxkKHJpZ2h0QmxvY2spXG5cbiAgICAgICAgY29uc3QgbGVmdEJsb2NrID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2JylcbiAgICAgICAgY29uc3QgdGl0bGVFbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpXG4gICAgICAgIHRpdGxlRWwuY2xhc3NMaXN0LmFkZCgncHJpbWFyeS1saW5lJylcbiAgICAgICAgdGl0bGVFbC50aXRsZSA9IGl0ZW0ubmFtZVxuICAgICAgICBsZWZ0QmxvY2suYXBwZW5kQ2hpbGQodGl0bGVFbClcblxuICAgICAgICBjb25zdCBxdWVyeSA9IHRoaXMuc2VsZWN0TGlzdFZpZXcuZ2V0UXVlcnkoKVxuICAgICAgICB0aGlzLmhpZ2hsaWdodE1hdGNoZXNJbkVsZW1lbnQoaXRlbS5kaXNwbGF5TmFtZSwgcXVlcnksIHRpdGxlRWwpXG5cbiAgICAgICAgaWYgKHNlbGVjdGVkKSB7XG4gICAgICAgICAgbGV0IHNlY29uZGFyeUVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2JylcbiAgICAgICAgICBzZWNvbmRhcnlFbC5jbGFzc0xpc3QuYWRkKCdzZWNvbmRhcnktbGluZScpXG4gICAgICAgICAgc2Vjb25kYXJ5RWwuc3R5bGUuZGlzcGxheSA9ICdmbGV4J1xuXG4gICAgICAgICAgaWYgKHR5cGVvZiBpdGVtLmRlc2NyaXB0aW9uID09PSAnc3RyaW5nJykge1xuICAgICAgICAgICAgc2Vjb25kYXJ5RWwuYXBwZW5kQ2hpbGQodGhpcy5jcmVhdGVEZXNjcmlwdGlvbihpdGVtLmRlc2NyaXB0aW9uLCBxdWVyeSkpXG4gICAgICAgICAgfVxuXG4gICAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkoaXRlbS50YWdzKSkge1xuICAgICAgICAgICAgY29uc3QgbWF0Y2hpbmdUYWdzID0gaXRlbS50YWdzXG4gICAgICAgICAgICAgIC5tYXAodCA9PiBbdCwgYXRvbS51aS5mdXp6eU1hdGNoZXIuc2NvcmUodCwgcXVlcnkpXSlcbiAgICAgICAgICAgICAgLmZpbHRlcigoW3QsIHNdKSA9PiBzID4gMClcbiAgICAgICAgICAgICAgLnNvcnQoKGEsIGIpID0+IGEucyAtIGIucylcbiAgICAgICAgICAgICAgLm1hcCgoW3QsIHNdKSA9PiB0KVxuXG4gICAgICAgICAgICBpZiAobWF0Y2hpbmdUYWdzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgc2Vjb25kYXJ5RWwuYXBwZW5kQ2hpbGQodGhpcy5jcmVhdGVUYWdzKG1hdGNoaW5nVGFncywgcXVlcnkpKVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cblxuICAgICAgICAgIGxlZnRCbG9jay5hcHBlbmRDaGlsZChzZWNvbmRhcnlFbClcbiAgICAgICAgfVxuXG4gICAgICAgIGxpLmFwcGVuZENoaWxkKGxlZnRCbG9jaylcbiAgICAgICAgcmV0dXJuIGxpXG4gICAgICB9LFxuICAgICAgZGlkQ29uZmlybVNlbGVjdGlvbjogKGtleUJpbmRpbmcpID0+IHtcbiAgICAgICAgdGhpcy5oaWRlKClcbiAgICAgICAgY29uc3QgZXZlbnQgPSBuZXcgQ3VzdG9tRXZlbnQoa2V5QmluZGluZy5uYW1lLCB7YnViYmxlczogdHJ1ZSwgY2FuY2VsYWJsZTogdHJ1ZX0pXG4gICAgICAgIHRoaXMuYWN0aXZlRWxlbWVudC5kaXNwYXRjaEV2ZW50KGV2ZW50KVxuICAgICAgfSxcbiAgICAgIGRpZENhbmNlbFNlbGVjdGlvbjogKCkgPT4ge1xuICAgICAgICB0aGlzLmhpZGUoKVxuICAgICAgfVxuICAgIH0pXG4gICAgdGhpcy5zZWxlY3RMaXN0Vmlldy5lbGVtZW50LmNsYXNzTGlzdC5hZGQoJ2NvbW1hbmQtcGFsZXR0ZScpXG4gIH1cblxuICBhc3luYyBkZXN0cm95ICgpIHtcbiAgICBhd2FpdCB0aGlzLnNlbGVjdExpc3RWaWV3LmRlc3Ryb3koKVxuICB9XG5cbiAgdG9nZ2xlICgpIHtcbiAgICBpZiAodGhpcy5wYW5lbCAmJiB0aGlzLnBhbmVsLmlzVmlzaWJsZSgpKSB7XG4gICAgICB0aGlzLmhpZGUoKVxuICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSgpXG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiB0aGlzLnNob3coKVxuICAgIH1cbiAgfVxuXG4gIGFzeW5jIHNob3cgKHNob3dIaWRkZW5Db21tYW5kcyA9IGZhbHNlKSB7XG4gICAgaWYgKCF0aGlzLnBhbmVsKSB7XG4gICAgICB0aGlzLnBhbmVsID0gYXRvbS53b3Jrc3BhY2UuYWRkTW9kYWxQYW5lbCh7aXRlbTogdGhpcy5zZWxlY3RMaXN0Vmlld30pXG4gICAgfVxuXG4gICAgaWYgKCF0aGlzLnByZXNlcnZlTGFzdFNlYXJjaCkge1xuICAgICAgdGhpcy5zZWxlY3RMaXN0Vmlldy5yZXNldCgpXG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuc2VsZWN0TGlzdFZpZXcucmVmcy5xdWVyeUVkaXRvci5zZWxlY3RBbGwoKVxuICAgIH1cblxuICAgIHRoaXMuYWN0aXZlRWxlbWVudCA9IChkb2N1bWVudC5hY3RpdmVFbGVtZW50ID09PSBkb2N1bWVudC5ib2R5KSA/IGF0b20udmlld3MuZ2V0VmlldyhhdG9tLndvcmtzcGFjZSkgOiBkb2N1bWVudC5hY3RpdmVFbGVtZW50XG4gICAgdGhpcy5rZXlCaW5kaW5nc0ZvckFjdGl2ZUVsZW1lbnQgPSBhdG9tLmtleW1hcHMuZmluZEtleUJpbmRpbmdzKHt0YXJnZXQ6IHRoaXMuYWN0aXZlRWxlbWVudH0pXG4gICAgY29uc3QgY29tbWFuZHNGb3JBY3RpdmVFbGVtZW50ID0gYXRvbS5jb21tYW5kc1xuICAgICAgICAuZmluZENvbW1hbmRzKHt0YXJnZXQ6IHRoaXMuYWN0aXZlRWxlbWVudH0pXG4gICAgICAgIC5maWx0ZXIoY29tbWFuZCA9PiBzaG93SGlkZGVuQ29tbWFuZHMgPT09ICEhY29tbWFuZC5oaWRkZW5JbkNvbW1hbmRQYWxldHRlKVxuICAgIGNvbW1hbmRzRm9yQWN0aXZlRWxlbWVudC5zb3J0KChhLCBiKSA9PiBhLmRpc3BsYXlOYW1lLmxvY2FsZUNvbXBhcmUoYi5kaXNwbGF5TmFtZSkpXG4gICAgYXdhaXQgdGhpcy5zZWxlY3RMaXN0Vmlldy51cGRhdGUoe2l0ZW1zOiBjb21tYW5kc0ZvckFjdGl2ZUVsZW1lbnR9KVxuXG4gICAgdGhpcy5wcmV2aW91c2x5Rm9jdXNlZEVsZW1lbnQgPSBkb2N1bWVudC5hY3RpdmVFbGVtZW50XG4gICAgdGhpcy5wYW5lbC5zaG93KClcbiAgICB0aGlzLnNlbGVjdExpc3RWaWV3LmZvY3VzKClcbiAgfVxuXG4gIGhpZGUgKCkge1xuICAgIHRoaXMucGFuZWwuaGlkZSgpXG4gICAgaWYgKHRoaXMucHJldmlvdXNseUZvY3VzZWRFbGVtZW50KSB7XG4gICAgICB0aGlzLnByZXZpb3VzbHlGb2N1c2VkRWxlbWVudC5mb2N1cygpXG4gICAgICB0aGlzLnByZXZpb3VzbHlGb2N1c2VkRWxlbWVudCA9IG51bGxcbiAgICB9XG4gIH1cblxuICBhc3luYyB1cGRhdGUgKHByb3BzKSB7XG4gICAgaWYgKHByb3BzLmhhc093blByb3BlcnR5KCdwcmVzZXJ2ZUxhc3RTZWFyY2gnKSkge1xuICAgICAgdGhpcy5wcmVzZXJ2ZUxhc3RTZWFyY2ggPSBwcm9wcy5wcmVzZXJ2ZUxhc3RTZWFyY2hcbiAgICB9XG4gIH1cblxuICBoaWdobGlnaHRNYXRjaGVzSW5FbGVtZW50ICh0ZXh0LCBxdWVyeSwgZWwpIHtcbiAgICBjb25zdCBtYXRjaGVzID0gYXRvbS51aS5mdXp6eU1hdGNoZXIubWF0Y2godGV4dCwgcXVlcnksIHtyZWNvcmRNYXRjaEluZGV4ZXM6IHRydWV9KVxuICAgIGxldCBtYXRjaGVkQ2hhcnMgPSBbXVxuICAgIGxldCBsYXN0SW5kZXggPSAwO1xuICAgIGNvbnN0IG1hdGNoSW5kZXhlcyA9IG1hdGNoZXMgPyAobWF0Y2hlcy5tYXRjaEluZGV4ZXMgPz8gW10pIDogW11cbiAgICBtYXRjaEluZGV4ZXMuZm9yRWFjaChtYXRjaEluZGV4ID0+IHtcbiAgICAgIGNvbnN0IHVubWF0Y2hlZCA9IHRleHQuc3Vic3RyaW5nKGxhc3RJbmRleCwgbWF0Y2hJbmRleClcbiAgICAgIGlmICh1bm1hdGNoZWQpIHtcbiAgICAgICAgaWYgKG1hdGNoZWRDaGFycy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgY29uc3QgbWF0Y2hTcGFuID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3BhbicpXG4gICAgICAgICAgbWF0Y2hTcGFuLmNsYXNzTGlzdC5hZGQoJ2NoYXJhY3Rlci1tYXRjaCcpXG4gICAgICAgICAgbWF0Y2hTcGFuLnRleHRDb250ZW50ID0gbWF0Y2hlZENoYXJzLmpvaW4oJycpXG4gICAgICAgICAgZWwuYXBwZW5kQ2hpbGQobWF0Y2hTcGFuKVxuICAgICAgICAgIG1hdGNoZWRDaGFycyA9IFtdXG4gICAgICAgIH1cblxuICAgICAgICBlbC5hcHBlbmRDaGlsZChkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZSh1bm1hdGNoZWQpKVxuICAgICAgfVxuXG4gICAgICBtYXRjaGVkQ2hhcnMucHVzaCh0ZXh0W21hdGNoSW5kZXhdKVxuICAgICAgbGFzdEluZGV4ID0gbWF0Y2hJbmRleCArIDFcbiAgICB9KVxuXG4gICAgaWYgKG1hdGNoZWRDaGFycy5sZW5ndGggPiAwKSB7XG4gICAgICBjb25zdCBtYXRjaFNwYW4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJylcbiAgICAgIG1hdGNoU3Bhbi5jbGFzc0xpc3QuYWRkKCdjaGFyYWN0ZXItbWF0Y2gnKVxuICAgICAgbWF0Y2hTcGFuLnRleHRDb250ZW50ID0gbWF0Y2hlZENoYXJzLmpvaW4oJycpXG4gICAgICBlbC5hcHBlbmRDaGlsZChtYXRjaFNwYW4pXG4gICAgfVxuXG4gICAgY29uc3QgdW5tYXRjaGVkID0gdGV4dC5zdWJzdHJpbmcobGFzdEluZGV4KVxuICAgIGlmICh1bm1hdGNoZWQpIHtcbiAgICAgIGVsLmFwcGVuZENoaWxkKGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKHVubWF0Y2hlZCkpXG4gICAgfVxuICB9XG5cbiAgZmlsdGVyID0gKGl0ZW1zLCBxdWVyeSkgPT4ge1xuICAgIGlmIChxdWVyeS5sZW5ndGggPT09IDApIHtcbiAgICAgIHJldHVybiBpdGVtc1xuICAgIH1cblxuICAgIGNvbnN0IHNjb3JlZEl0ZW1zID0gW11cbiAgICBmb3IgKGNvbnN0IGl0ZW0gb2YgaXRlbXMpIHtcbiAgICAgIGxldCBzY29yZSA9IGF0b20udWkuZnV6enlNYXRjaGVyLnNjb3JlKGl0ZW0uZGlzcGxheU5hbWUsIHF1ZXJ5KVxuICAgICAgaWYgKGl0ZW0udGFncykge1xuICAgICAgICBzY29yZSArPSBpdGVtLnRhZ3MucmVkdWNlKFxuICAgICAgICAgIChjdXJyZW50U2NvcmUsIHRhZykgPT4gY3VycmVudFNjb3JlICsgYXRvbS51aS5mdXp6eU1hdGNoZXIuc2NvcmUodGFnLCBxdWVyeSksXG4gICAgICAgICAgMFxuICAgICAgICApXG4gICAgICB9XG4gICAgICBpZiAoaXRlbS5kZXNjcmlwdGlvbikge1xuICAgICAgICBzY29yZSArPSBhdG9tLnVpLmZ1enp5TWF0Y2hlci5zY29yZShpdGVtLmRlc2NyaXB0aW9uLCBxdWVyeSlcbiAgICAgIH1cblxuICAgICAgaWYgKHNjb3JlID4gMCkge1xuICAgICAgICBzY29yZWRJdGVtcy5wdXNoKHtpdGVtLCBzY29yZX0pXG4gICAgICB9XG4gICAgfVxuICAgIHNjb3JlZEl0ZW1zLnNvcnQoKGEsIGIpID0+IGIuc2NvcmUgLSBhLnNjb3JlKVxuICAgIHJldHVybiBzY29yZWRJdGVtcy5tYXAoKGkpID0+IGkuaXRlbSlcbiAgfVxuXG4gIGNyZWF0ZURlc2NyaXB0aW9uIChkZXNjcmlwdGlvbiwgcXVlcnkpIHtcbiAgICBjb25zdCBkZXNjcmlwdGlvbkVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2JylcblxuICAgIC8vIGluIGNhc2Ugb2Ygb3ZlcmZsb3csIGdpdmUgZnVsbCBjb250ZW50cyBvbiBsb25nIGhvdmVyXG4gICAgZGVzY3JpcHRpb25FbC50aXRsZSA9IGRlc2NyaXB0aW9uXG5cbiAgICBPYmplY3QuYXNzaWduKGRlc2NyaXB0aW9uRWwuc3R5bGUsIHtcbiAgICAgIGZsZXhHcm93OiAxLFxuICAgICAgZmxleFNocmluazogMSxcbiAgICAgIHRleHRPdmVyZmxvdzogJ2VsbGlwc2lzJyxcbiAgICAgIHdoaXRlU3BhY2U6ICdub3dyYXAnLFxuICAgICAgb3ZlcmZsb3c6ICdoaWRkZW4nXG4gICAgfSlcbiAgICB0aGlzLmhpZ2hsaWdodE1hdGNoZXNJbkVsZW1lbnQoZGVzY3JpcHRpb24sIHF1ZXJ5LCBkZXNjcmlwdGlvbkVsKVxuICAgIHJldHVybiBkZXNjcmlwdGlvbkVsXG4gIH1cblxuICBjcmVhdGVUYWcgKHRhZ1RleHQsIHF1ZXJ5KSB7XG4gICAgY29uc3QgdGFnRWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdsaScpXG4gICAgT2JqZWN0LmFzc2lnbih0YWdFbC5zdHlsZSwge1xuICAgICAgYm9yZGVyQm90dG9tOiAwLFxuICAgICAgZGlzcGxheTogJ2lubGluZScsXG4gICAgICBwYWRkaW5nOiAwXG4gICAgfSlcbiAgICB0aGlzLmhpZ2hsaWdodE1hdGNoZXNJbkVsZW1lbnQodGFnVGV4dCwgcXVlcnksIHRhZ0VsKVxuICAgIHJldHVybiB0YWdFbFxuICB9XG5cbiAgY3JlYXRlVGFncyAobWF0Y2hpbmdUYWdzLCBxdWVyeSkge1xuICAgIGNvbnN0IHRhZ3NFbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ29sJylcbiAgICBPYmplY3QuYXNzaWduKHRhZ3NFbC5zdHlsZSwge1xuICAgICAgZGlzcGxheTogJ2lubGluZScsXG4gICAgICBtYXJnaW5MZWZ0OiAnNHB4JyxcbiAgICAgIGZsZXhTaHJpbms6IDAsXG4gICAgICBwYWRkaW5nOiAwXG4gICAgfSlcblxuICAgIGNvbnN0IGludHJvRWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzdHJvbmcnKVxuICAgIGludHJvRWwudGV4dENvbnRlbnQgPSAnbWF0Y2hpbmcgdGFnczogJ1xuXG4gICAgdGFnc0VsLmFwcGVuZENoaWxkKGludHJvRWwpXG4gICAgbWF0Y2hpbmdUYWdzLm1hcCh0ID0+IHRoaXMuY3JlYXRlVGFnKHQsIHF1ZXJ5KSkuZm9yRWFjaCgodGFnRWwsIGkpID0+IHtcbiAgICAgIHRhZ3NFbC5hcHBlbmRDaGlsZCh0YWdFbClcbiAgICAgIGlmIChpIDwgbWF0Y2hpbmdUYWdzLmxlbmd0aCAtIDEpIHtcbiAgICAgICAgY29uc3QgY29tbWFTcGFjZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKVxuICAgICAgICBjb21tYVNwYWNlLnRleHRDb250ZW50ID0gJywgJ1xuICAgICAgICB0YWdzRWwuYXBwZW5kQ2hpbGQoY29tbWFTcGFjZSlcbiAgICAgIH1cbiAgICB9KVxuICAgIHJldHVybiB0YWdzRWxcbiAgfVxufVxuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7QUFFQTtBQUNBO0FBQWlEO0FBSGpEOztBQUtlLE1BQU1BLGtCQUFrQixDQUFDO0VBQ3RDQyxXQUFXLENBQUVDLHlCQUF5QixHQUFHLEVBQUUsRUFBRTtJQUFBLEtBb0s3Q0MsTUFBTSxHQUFHLENBQUNDLEtBQUssRUFBRUMsS0FBSyxLQUFLO01BQ3pCLElBQUlBLEtBQUssQ0FBQ0MsTUFBTSxLQUFLLENBQUMsRUFBRTtRQUN0QixPQUFPRixLQUFLO01BQ2Q7TUFFQSxNQUFNRyxXQUFXLEdBQUcsRUFBRTtNQUN0QixLQUFLLE1BQU1DLElBQUksSUFBSUosS0FBSyxFQUFFO1FBQ3hCLElBQUlLLEtB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