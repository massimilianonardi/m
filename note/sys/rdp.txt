
UBUNTU RDP PERSISTENT:
sudo nano /etc/gdm3/custom.conf
AutomaticLoginEnable=true
AutomaticLogin=USERNAME



XRDP:

complete install and config:

sudo apt install xrdp -y
sudo service xrdp stop
sudo adduser xrdp ssl-cert
sudo sed -i 's|port=3389|port=3391|g' "/etc/xrdp/xrdp.ini"
cat > ~/.xsessionrc << EOF
export GNOME_SHELL_SESSION_MODE=ubuntu
export XDG_CURRENT_DESKTOP=ubuntu:GNOME
export XDG_CONFIG_DIRS=/etc/xdg/xdg-ubuntu:/etc/xdg
EOF
sudo sed -i 's|<allow_any>no</allow_any>|<allow_any>auth_admin_keep</allow_any>|g' "/usr/share/polkit-1/actions/org.gnome.controlcenter.user-accounts.policy"
sudo /bin/sh -c "cat > /etc/polkit-1/rules.d/50-allow-sudoers.rules" << EOF
polkit.addRule(function(action, subject) {
    if (subject.isInGroup("sudo")) {
        return polkit.Result.YES;
    }
});
EOF
sudo systemctl daemon-reload
sudo service polkit restart
sudo service xrdp start

install:
sudo apt install xrdp -y
sudo systemctl status xrdp
sudo adduser xrdp ssl-cert
sudo systemctl restart xrdp

change port:
sudo nano /etc/xrdp/xrdp.ini
sudo sed -i 's|port=3389|port=3391|g' "/etc/xrdp/xrdp.ini"

change from gnome-session to ubuntu-session:
nano ~/.xsessionrc
export GNOME_SHELL_SESSION_MODE=ubuntu
export XDG_CURRENT_DESKTOP=ubuntu:GNOME
export XDG_CONFIG_DIRS=/etc/xdg/xdg-ubuntu:/etc/xdg
cat > ~/.xsessionrc << EOF
export GNOME_SHELL_SESSION_MODE=ubuntu
export XDG_CURRENT_DESKTOP=ubuntu:GNOME
export XDG_CONFIG_DIRS=/etc/xdg/xdg-ubuntu:/etc/xdg
EOF
logout and login

enable administration for sudoers:
pkaction --version
must be > 0.106
sudo sed -i 's|<allow_any>no</allow_any>|<allow_any>auth_admin_keep</allow_any>|g' "/usr/share/polkit-1/actions/org.gnome.controlcenter.user-accounts.policy"
sudo /bin/sh -c "cat > /etc/polkit-1/rules.d/50-allow-useradmin.rules" << EOF
polkit.addRule(function(action, subject) {
    if (subject.isInGroup("sudo")) {
        return polkit.Result.YES;
    }
});
EOF
sudo systemctl daemon-reload
sudo service polkit restart

change keyboard:
setxkbmap -query
setxkbmap it

enable firewall:
sudo ufw allow from 192.168.0.0/24 to any port 3389
sudo ufw allow 3389/tcp
sudo ufw reload

enable multi user mode:
sudo apt-get install dbus-x11
sudo nano /etc/xrdp/startwm.sh
add the following line before last line: "exec /bin/sh /etc/X11/Xsession"
test -x /etc/X11/Xsession && exec /etc/X11/Xsession.
sudo nano /etc/X11/Xsession
add the following line at beginning just after shebang line
export $(dbus-launch)
sudo reboot

vm mount shared folder with host:
sudo vmhgfs-fuse .host:/shared /mnt/hgfs/shared -o allow_other -o uid=1000

--------------------------------------------------------------------------------

GNOME DISABLE LOCK SCREEN HOTKEY
gsettings get org.gnome.desktop.lockdown disable-lock-screen
gsettings set org.gnome.desktop.lockdown disable-lock-screen true
