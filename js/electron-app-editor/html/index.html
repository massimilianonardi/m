<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>Electron App</title>
    <link rel="stylesheet" href="style/style.css">
    <script src="js/main.js"></script>
    <script>
      // function update(text)
      // {
      //   let result_element = document.querySelector("#highlighting-content");
      //   // Update code
      //   // result_element.innerText = text;
      //   result_element.innerHTML = text;
      //   // Syntax Highlight
      //   Prism.highlightElement(result_element);
      // }
      function m_edit_on_keydown(event)
      {
        console.log(event);
        console.log(document.getSelection());
        // console.log(document.activeElement);
        // event.preventDefault();
        // return;
        // var keyEvent = new KeyboardEvent("keydown",
        // {
        //   key: event.key,
        //   code: event.code,
        //   location: event.location,
        //   repeat: event.repeat,
        //   isComposing: event.isComposing,
        //   charCode: event.charCode,
        //   keyCode: event.keyCode,
        //   which: event.which,
        //   ctrlKey: event.ctrlKey,
        //   shiftKey: event.shiftKey,
        //   altKey: event.altKey,
        //   metaKey: event.metaKey
        // });
        // var m_edit_text = document.getElementById("m-edit-text");
        // m_edit_text.focus();
        // m_edit_text.dispatchEvent(keyEvent);
        var selection = document.getSelection();
        var focusNode = selection.focusNode;
        console.log(focusNode, focusNode.parentNode.dataset);
        if(event.keyCode == 13 && event.shiftKey == false)
        {
          event.preventDefault();
          // document.execCommand("insertLineBreak");
          var selection = document.getSelection();
          if(selection.type === "Caret")
          {
          }
          else
          {
            console.log("error! Not a selection caret!", selection.type);
          }
        }
      }

      function m_edit_on_keyup(event)
      {
        return;

        console.log(event);
        console.log(document.getSelection());
        // console.log(document.activeElement);
        if(event.keyCode == 13 && event.shiftKey == false)
        {
          event.preventDefault();
          // document.execCommand("insertLineBreak");
          var selection = document.getSelection();
          if(selection.type === "Caret")
          {
          }
          else
          {
            console.log("error! Not a selection caret!", selection.type);
          }
        }
      }
    </script>
  </head>
  <body>

    <a href="editor.html">editor</a>
    <a href="editor_1.html">editor_1</a>
    <a href="editor_2.html">editor_2</a>
    <a href="editor_3.html">editor_3</a>

    <!-- <pre id="m-edit" class="m-edit-pre" contenteditable="true" spellcheck="false" oninput="m_edit_on_input(this);"> -->
    <!-- <pre id="m-edit" class="m-edit-pre" contenteditable="true" spellcheck="false" onkeydown="m_edit_on_input(this);"> -->
    <!-- <pre id="m-edit" class="m-edit-pre" contenteditable="true" spellcheck="false" onbeforeinput="m_edit_on_input(this);"> -->
    <!-- <pre id="m-edit" class="m-edit-pre" contenteditable="true" spellcheck="false" onbeforeinput="m_edit_on_input(event)"> -->
    <pre id="m-edit" class="m-edit-pre" contenteditable="true" spellcheck="false" onkeydown="m_edit_on_keydown(event)">
      <code data-row-number="1">first line</code>
      <code data-row-number="2">   indented line followed by empty line</code>
      <code data-row-number="3"></code>
      <code data-row-number="4">the following <b data-row-number="4" data-col-number="14">line consists</b> of one single space</code>
      <code data-row-number="5"> </code>
      <code data-row-number="6">this line has a space at the end </code>
      <code data-row-number="7">&#9;and one leadi<span class="caret"></span>ng and ending tab&#9;</code>
      <code data-row-number="8">fill to</code>
      <code data-row-number="9">ten</code>
      <code data-row-number="10">lines</code>
    </pre>

    <textarea id="m-edit-text" spellcheck="false" onkeyup="m_edit_on_keyup(event)"></textarea>

    <!-- <pre id="highlighting" aria-hidden="true" class="code" contenteditable="true" spellcheck="false">
      pre: my test
      <div><code> </code></div>
      <code id="highlighting-content" class="language-html" contenteditable="true"></code>
    </pre>
    <textarea id="editing" spellcheck="false" oninput="update(this.value);"></textarea>
    https://css-tricks.com/creating-an-editable-textarea-that-supports-syntax-highlighted-code/ -->

  </body>
    <!-- <script>
      document.execCommand('defaultParagraphSeparator', false, 'p');
    </script> -->
</html>
